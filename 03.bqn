iâ†{âˆ¾âŸœ((âŠ‘â‰¢ğ•©)â¥Š'.')âŒ¾â‰ğ•©}>â€¢FLines "03.in"
inumsâ†10â‰ "0123456789"âŠi
igearsâ†{ğ•©Ã— 2+ +`âŒ¾â¥Š ğ•©}'*'â·i
isymsâ†(1-(i='.'))-inums
caPart1â†inums+2Ã—isyms
caPart2â†inums+igears

DilateAdjâ†{(DilateOrtho ğ•©)++Â´âŸ¨Â»âŒ¾â‰ Â»ğ•©, Â»âŒ¾â‰ Â«ğ•©, Â«âŒ¾â‰ Â»ğ•©, Â«âŒ¾â‰ Â«ğ•©âŸ©}
DilateOrthoâ†{+Â´âŸ¨ğ•©,Â»ğ•©,Â«ğ•©,Â»âŒ¾â‰ğ•©,Â«âŒ¾â‰ğ•©âŸ©}

# Part 1
StepCA1â†{
  numsâ†1=ğ•©
  symsâ†2=ğ•©
  sigsâ†3=ğ•©
  newThreesâ†0â‰ (2=nums+0â‰ DilateOrtho sigs)+(2=nums+0â‰ DilateAdj syms)
  ğ•©âŒˆ3Ã—newThrees
}
finalCAâ†3=StepCA1âŸ100 caPart1
indicesâ†/â¥ŠfinalCA
+Â´ â€¢ParseFloatÂ¨ (âŠ indices-â†•â‰ indices)âŠ”indicesâŠâ¥Ši

# Part 2
# Each gear is given a unique CA value > 3, and those values are propagated same as part 1.
Spâ†{ğ•©âŠ”Ëœ-âŸœ1(ğ•©â‰ ğ•¨)Ã—(1âŠ¸+ +` ğ•©=ğ•¨)}
StepCA2â†{
  numsâ†1=ğ•©
  sigsâ†2=ğ•©
  gearsâ†ğ•©Ã—2<ğ•©
  ğ•©âŒˆnumsÃ—DilateAdj gears
}
finalCA2â†{ğ•©Ã—ğ•©>2} StepCA2âŸ100 caPart2
+Â´ Ã—Â´Â¨ {ğ•© /Ëœ 2=â‰ Â¨ğ•©} â€¢ParseFloatâš‡1 '*'SpÂ¨ (-âŸœ1{ğ•©Ã—ğ•©>0}finalCA2-2)âŠ”i
